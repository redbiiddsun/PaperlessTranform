import unittest
from parse import TextParse

class TestFormParser(unittest.TestCase):

    test_suit = {
        "form_1": {
                "raw_text": """ใบยืม : อุปกรณ์

                วันที่....... เดือน............................... พ.ศ...................

                เรื่อง ขออนุญาตยืมอุปกรณ์
                เรียน ผู้อำนวยการสำนักงานกิจการนักศึกษา

                ชื่อ........................................................... นามสกุล...........................................................
                รหัสนักศึกษา...........................................................
                สังกัดหน่วยงาน..............(เช่น สโมสรฯ ชมรมฯ ภาควิชา)...............................
                โทรศัพท์ที่สามารถติดต่อได้....................................................................

                ขอยืมไปใช้ในงาน................................................................................

                ในวันที่........... เดือน................. พ.ศ................... ถึง วันที่........... เดือน................. พ.ศ...................
                ขอคืนภายใน วันที่........... เดือน................. พ.ศ...................

                ลำดับที่    รายการอุปกรณ์ที่ขอยืมไปใช้กิจกรรม    จำนวน
                1.กรณีอุปกรณ์ แตกหัก ชำรุด สูญหาย จะต้องชดใช้ คืนตามความเหมาะสมให้ครบถ้วน
                ผู้ยืมลงชื่อ..................

                .........................................
                (...........................................................)

                ผู้อนุญาตลงชื่อ...........................................................
                (...........................................................)

                เจ้าหน้าที่ลงชื่อ...........................................................
                (...........................................................)

                หมายเหตุ:ส่งคืนอุปกรณ์ที่สำนักงานกิจการนักศึกษา

                วันที่............... เดือน............... พ.ศ...............""",

                "expected_labels": []
        },
                "form_2": {
                "raw_text": """จดหมายลาป่วย

                    วันที่..........................................................

                    เรียน อาจารย์.......................................................................

                    เรื่อง  ขออนุญาตลาป่วย

                    ด้วยข้าพเจ้า นาย / นางสาว............................รหัส............................
                    ซึ่งลงทะเบียนเรียนวิชา 1010 ............................กลุ่ม ............................
                    เรียนวัน........................ เวลา .............................น. มีอาการป่วย.............................................................................ในวันที่....................................................................ดังนั้นจึงขอลาป่วยเป็นเวลา................................................วัน ในวันที่.........................................................................................โดยได้แนบใบรับรองแพทย์มาพร้อมนี้
                        จึงเรียนมาเพื่อโปรดพิจารณา
                    (……………………………………….)
                            นิสิต""",

                "expected_labels": []
        },
             "form_3": {
                "raw_text": """ใบลาออก
                    เรื่อง ขอลาออก
                    เรียน .......................................................................................................
                    ข้าพเจ้านาย/นาง/นางสาว................................................................................พนักงานตำแหน่ง
                    ...........................................................................................มีความประสงค์ขอลาออกจากการเป็นพนักงานจ้างเหมา
                    เนื่องด้วยเหตุผล..........................................................................................................................................................
                    จึงขอสิ้นสุดการทา งาน ต้งัแต่วนั ที่.....................เดือน...............................................พ.ศ.......................
                    จึงเรียนมาเพื่อโปรดทราบ
                    ขอแสดงความนับถือ
                    .......................................................................
                    (....................................................................)""",
                "expected_labels": []
        },
            "form_4": {
                "raw_text": """แบบฟอร์มการแจ้งข้อร้องเรียนของลูกค้าและการติดตามผล

                1. วันที่ร้องเรียน............./................/...............
                2. เรื่องที่ร้องเรียนเกี่ยวกับ	  สินค้า	  การบริการวิชาการ	  การบริการ 	    บรรจุภัณฑ์
                3. ข้อมูลผู้ร้องเรียน
                ชื่อ – สกุล......................................................................... สังกัดหน่วยงาน......................................................................
                ..........................................................................................................................................................................................................
                โทรศัพท์...........................................................................................................................................................................................
                โทรสาร..................................................................................E-mail............................................................................................
                4. รายละเอียดการร้องเรียน 
                4.1	รายละเอียดของสินค้า หรือ บริการตามข้อตกลง / ใบยืนยัน
                (1)	เลขที่ใบส่งสินค้าและใบแจ้งหนี้.................................................................................................................
                (2)	วันที่รับสินค้า / รับบริการ.........................................................................................................................
                (3)	รายการสินค้า / บริการ.............................................................................................................................
                    ........................................................................................................................................................................................................................................................................................................................
                    ........................................................................................................................................................................................................................................................................................................................
                4.2	รายละเอียดของสินค้า หรือ บริการที่ร้องเรียน / ที่ไม่เป็นไปตามข้อตกลง
                ................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
                ........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
                """,
                "expected_labels": ['วันที่ร้องเรียน', 'ชื่อ – สกุล', 'สังกัดหน่วยงาน', 'โทรศัพท์', 'โทรสาร', 'E-mail', 'เลขที่ใบส่งสินค้าและใบแจ้งหนี้', 'วันที่รับสินค้า / รับบริการ', 'รายการสินค้า / บริการ',]
        },
    }


 

    def test_parse(self):
        # self.assertEqual(TextParse.extract_labels(self.test_suit['form_1']['raw_text']), self.test_suit['form_1']['expected_labels'])
        # self.assertEqual(TextParse.extract_labels(self.test_suit['form_2']['raw_text']), self.test_suit['form_2']['expected_labels'])
        # self.assertEqual(TextParse.extract_labels(self.test_suit['form_3']['raw_text']), self.test_suit['form_3']['expected_labels'])
        self.assertCountEqual(TextParse.extract_labels(self.test_suit['form_4']['raw_text']), self.test_suit['form_4']['expected_labels'])


if __name__ == '__main__':
    unittest.main()